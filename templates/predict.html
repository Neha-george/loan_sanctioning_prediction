{% extends "base.html" %}

{% block title %}Loan Prediction - LoanAI{% endblock %}

{% block content %}
<section class="predict-section">
    <div class="container">
        <div class="text-center mb-5">
            <h1 class="display-5 fw-bold mb-3">Loan Eligibility Prediction</h1>
            <p class="lead text-muted">Fill in your details to get instant loan approval prediction</p>
        </div>

        <div class="row justify-content-center">
            <div class="col-lg-10">
                <div class="prediction-card">
                    <form action="/predict" method="POST" id="predictionForm">
                        
                        <div class="form-section">
                            <div class="section-header">
                                <i class="bi bi-person-circle"></i>
                                <h3>Personal Information</h3>
                            </div>
                            
                            <div class="row g-4">
                                <div class="col-md-6">
                                    <label for="gender" class="form-label">Gender</label>
                                    <select class="form-control" id="gender" name="gender" required>
                                        <option value="">Select Gender</option>
                                        <option value="Male">Male</option>
                                        <option value="Female">Female</option>
                                    </select>
                                </div>

                                <div class="col-md-6">
                                    <label for="married" class="form-label">Marital Status</label>
                                    <select class="form-control" id="married" name="married" required>
                                        <option value="">Select Status</option>
                                        <option value="Yes">Married</option>
                                        <option value="No">Single</option>
                                    </select>
                                </div>

                                <div class="col-md-6">
                                    <label for="dependents" class="form-label">Number of Dependents</label>
                                    <select class="form-control" id="dependents" name="dependents" required>
                                        <option value="">Select Dependents</option>
                                        <option value="0">0</option>
                                        <option value="1">1</option>
                                        <option value="2">2</option>
                                        <option value="3+">3+</option>
                                    </select>
                                </div>

                                <div class="col-md-6">
                                    <label for="education" class="form-label">Education Level</label>
                                    <select class="form-control" id="education" name="education" required>
                                        <option value="">Select Education</option>
                                        <option value="Graduate">Graduate</option>
                                        <option value="Not Graduate">Not Graduate</option>
                                    </select>
                                </div>

                                <div class="col-md-6">
                                    <label for="self_employed" class="form-label">Employment Type</label>
                                    <select class="form-control" id="self_employed" name="self_employed" required>
                                        <option value="">Select Employment</option>
                                        <option value="Yes">Self Employed</option>
                                        <option value="No">Salaried</option>
                                    </select>
                                </div>

                                <div class="col-md-6">
                                    <label for="property_area" class="form-label">Property Area</label>
                                    <select class="form-control" id="property_area" name="property_area" required>
                                        <option value="">Select Area</option>
                                        <option value="Urban">Urban</option>
                                        <option value="Semiurban">Semi Urban</option>
                                        <option value="Rural">Rural</option>
                                    </select>
                                </div>
                                <div class="col-md-6">
                                    <label for="purpose" class="form-label">Purpose of Loan</label>
                                    <select class="form-control" id="purpose" name="purpose" required>
                                        <option value="">Select Purpose</option>
                                        <option value="Home Purchase">Home Purchase</option>
                                        <option value="Home Renovation">Home Renovation</option>
                                        <option value="Education">Education</option>
                                        <option value="Business">Business</option>
                                        <option value="Medical">Medical</option>
                                        <option value="Car">Car</option>
                                        <option value="Debt Consolidation">Debt Consolidation</option>
                                        <option value="Wedding">Wedding</option>
                                        <option value="Other">Other</option>
                                    </select>
                                </div>
                            </div>
                        </div>

                        <div class="form-section">
                            <div class="section-header">
                                <i class="bi bi-currency-dollar"></i>
                                <h3>Financial Information</h3>
                            </div>
                            
                            <div class="row g-4">
                                <div class="col-md-6">
                                    <label for="applicant_income" class="form-label">Applicant Income (Monthly)</label>
                                    <div class="input-group">
                                        <span class="input-group-text"><i class="bi bi-cash"></i></span>
                                        <input type="number" class="form-control" id="applicant_income" 
                                               name="applicant_income" placeholder="e.g., 50000" 
                                               min="0" step="1000" required>
                                    </div>
                                </div>

                                <div class="col-md-6">
                                    <label for="coapplicant_income" class="form-label">Co-applicant Income (Monthly)</label>
                                    <div class="input-group">
                                        <span class="input-group-text"><i class="bi bi-cash-stack"></i></span>
                                        <input type="number" class="form-control" id="coapplicant_income" 
                                               name="coapplicant_income" placeholder="e.g., 25000" 
                                               min="0" step="1000" value="0" required>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="form-section">
                            <div class="section-header">
                                <i class="bi bi-bank"></i>
                                <h3>Loan Details</h3>
                            </div>
                            
                            <div class="row g-4">
                                <div class="col-md-6">
                                    <label for="loan_amount" class="form-label">Loan Amount</label>
                                    <div class="input-group">
                                        <span class="input-group-text"><i class="bi bi-wallet2"></i></span>
                                        <input type="number" class="form-control" id="loan_amount" 
                                               name="loan_amount" placeholder="e.g., 150000" 
                                               min="1000" step="1000" required>
                                    </div>
                                    <small class="text-muted">Enter amount in rupees</small>
                                </div>

                                <div class="col-md-6">
                                    <label for="loan_amount_term" class="form-label">Loan Term (months)</label>
                                    <div class="input-group">
                                        <span class="input-group-text"><i class="bi bi-calendar-range"></i></span>
                                        <select class="form-control" id="loan_amount_term" name="loan_amount_term" required>
                                            <option value="">Select Term</option>
                                            <option value="12">12 months (1 year)</option>
                                            <option value="60">60 months (5 years)</option>
                                            <option value="120">120 months (10 years)</option>
                                            <option value="180">180 months (15 years)</option>
                                            <option value="240">240 months (20 years)</option>
                                            <option value="300">300 months (25 years)</option>
                                            <option value="360">360 months (30 years)</option>
                                        </select>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="form-section">
                            <div class="section-header">
                                <i class="bi bi-bar-chart-line"></i>
                                <h3>Credit Information</h3>
                            </div>
                            
                            <div class="row g-4">
                                <div class="col-12">
                                    <label for="credit_score" class="form-label">Credit Score</label>
                                    <div class="input-group">
                                        <span class="input-group-text"><i class="bi bi-graph-up"></i></span>
                                        <input type="number" class="form-control" id="credit_score" 
                                               name="credit_score" placeholder="e.g., 750" 
                                               min="300" max="900" required>
                                    </div>
                                </div>

                                <div class="col-12">
                                    <div class="credit-score-legend">
                                        <h6 class="mb-3">Credit Score Guide:</h6>
                                        <div class="row g-3">
                                            <div class="col-md-6 col-lg-4">
                                                <div class="score-range excellent">
                                                    <i class="bi bi-star-fill"></i>
                                                    <div>
                                                        <strong>800 - 900</strong>
                                                        <span>Excellent</span>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="col-md-6 col-lg-4">
                                                <div class="score-range very-good">
                                                    <i class="bi bi-hand-thumbs-up-fill"></i>
                                                    <div>
                                                        <strong>750 - 799</strong>
                                                        <span>Very Good</span>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="col-md-6 col-lg-4">
                                                <div class="score-range good">
                                                    <i class="bi bi-check-circle-fill"></i>
                                                    <div>
                                                        <strong>701 - 749</strong>
                                                        <span>Good</span>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="col-md-6 col-lg-4">
                                                <div class="score-range fair">
                                                    <i class="bi bi-dash-circle-fill"></i>
                                                    <div>
                                                        <strong>651 - 700</strong>
                                                        <span>Fair</span>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="col-md-6 col-lg-4">
                                                <div class="score-range low">
                                                    <i class="bi bi-exclamation-circle-fill"></i>
                                                    <div>
                                                        <strong>300 - 650</strong>
                                                        <span>Low</span>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="text-center mt-4">
                            <button type="submit" class="btn btn-primary btn-lg px-5">
                                <i class="bi bi-calculator me-2"></i>Get Prediction
                            </button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>
</section>

<script>
    document.getElementById("predictionForm").addEventListener("submit", function(e) {
        const submitBtn = this.querySelector("button[type='submit']");
        submitBtn.disabled = true;
        submitBtn.innerHTML = '<i class="bi bi-hourglass-split me-2"></i>Processing...';
    });

    const creditScoreInput = document.getElementById("credit_score");
    creditScoreInput.addEventListener("input", function() {
        const score = parseInt(this.value);
        const ranges = document.querySelectorAll(".score-range");
        
        ranges.forEach(range => range.classList.remove("active"));
        
        if (score >= 800 && score <= 900) {
            ranges[0].classList.add("active");
        } else if (score >= 750 && score < 800) {
            ranges[1].classList.add("active");
        } else if (score >= 701 && score < 750) {
            ranges[2].classList.add("active");
        } else if (score >= 651 && score < 701) {
            ranges[3].classList.add("active");
        } else if (score >= 300 && score <= 650) {
            ranges[4].classList.add("active");
        }
    });

    document.querySelectorAll("input[type='number']").forEach(input => {
        input.addEventListener("blur", function() {
            if (this.value && !isNaN(this.value)) {
                this.classList.add("is-valid");
            }
        });
    });
</script>
{% endblock %}